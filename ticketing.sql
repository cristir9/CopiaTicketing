CREATE DATABASE TICKETING;

CREATE TABLE TIPO_USUARIO(
ID_USUARIO INTEGER AUTOINCREMENT PRIMARY KEY,
NOMBRE VARCHAR(30)
);
CREATE TABLE DISPOSITIVO(
ID_DISPOSITIVO INTEGER PRIMARY KEY AUTOINCREMENT,
TIPO VARCHAR(30) NOT NULL,
MARCA VARCHAR(30) NOT NULL,
MODELO VARCHAR(30) NOT NULL,
DESCRIPCION VARCHAR(150)
);

CREATE TABLE ESTADO(
ID_ESTADO INTEGER PRIMARY KEY AUTOINCREMENT,
NOMBRE VARCHAR(50)NOT NULL
);

CREATE TABLE TIPO_INCIDENCIA(
ID_TIPOINCIDENCIA INTEGER PRIMARY KEY AUTOINCREMENT,
NOMBRE VARCHAR(50)NOT NULL
);

CREATE TABLE PRIORIDAD(
ID_PRIORIDAD INTEGER PRIMARY KEY AUTOINCREMENT,
NOMBRE VARCHAR(50)NOT NULL
);

CREATE TABLE INCIDENCIA(
ID_INICIDENCIA INTEGER PRIMARY KEY AUTOINCREMENT,
FECHA_INICIO DATE NOT NULL,
FECHA_FIN DATE,
ID_ESTADO INTEGER NOT NULL,
ID_USUARIO INTEGER NOT NULL,
ID_TIPOINCIDENCIA INTEGER NOT NULL,
ID_DISPOSITIVO INTEGER NOT NULL,
DESCRIPCION_INCIDENCIA VARCAHR(500),
DESCRIPCION_SOLUCION VARCHAR(500),
ID_PRIORIDAD INTEGER NOT NULL,
ID_USUARIO INTEGER NOT NULL,
CONSTRAINT FK_TECNICO FOREIGN KEY (ID_USUARIO) REFERENCES USUARIO (ID_USUARIO),
CONSTRAINT FK_DISPOSITIVO FOREIGN KEY (ID_DISPOSITIVO) REFERENCES DISPOSITIVO (ID_DISPOSITIVO),
CONSTRAINT FK_PRIORIDAD FOREIGN KEY (ID_PRIORIDAD) REFERENCES PRIORIDAD (ID_PRIORIDAD),
CONSTRAINT FK_TIPOINCIDENCIA FOREIGN KEY (ID_TIPOINCIDENCIA) REFERENCES TIPO_INCIDENCIA (ID_TIPOINCIDENCIA),
CONSTRAINT FK_ESTADO FOREIGN KEY (ID_ESTADO) REFERENCES ESTADO(ID_ESTADO)
);

CREATE TABLE USUARIO(
ID_USUARIO INTEGER PRIMARY KEY AUTOINCREMENT,
NOMBRE VARCAHR(50) NOT NULL,
APELLIDO VARCHAR(50) NOT NULL,
NICKNAME VARCAHR(50) NOT NULL,
CONTRASENA VARCHAR(30) NOT NULL,
EMAIL VARCAHR(50) NOT NULL,
IS_ACTIVO BOOLEAN NOT NULL,
ID_TIPOUSUARIO INTEGER NOT NULL,
CONSTRAINT FK_TIPO_USUARIO FOREIGN KEY  (ID_TIPOUSUARIO) REFERENCES TIPO_SUARIO(COD_USUARIO),
CONSTRAINT FK_ID_USUARIO FOREIGN KEY  (ID_USUARIO) REFERENCES INCIDENCIA(ID_USUARIO)
);

INSERT INTO TIPO_USUARIO VALUES (0 ,'ADMINISTRADOR');
INSERT INTO TIPO_USUARIO VALUES (1 , 'TECNICO');
INSERT INTO TIPO_USUARIO VALUES (2 , 'USUARIO');

INSERT INTO ESTADO VALUES (0,'ABIERTO');
INSERT INTO ESTADO VALUES (1,'EN TRAMITE');
INSERT INTO ESTADO VALUES (2,'CERRADO');
INSERT INTO ESTADO VALUES (3,'RESUELTO');

INSERT INTO PRIORIDAD VALUES (0,'ALTA');
INSERT INTO PRIORIDAD VALUES (1,'BAJA');
INSERT INTO PRIORIDAD VALUES (2,'MEDIA');




